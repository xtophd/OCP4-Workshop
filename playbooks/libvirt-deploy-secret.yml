## Authors: 
##   Christoph Doerbeck
##
## Summary:
##
##
##

---
- hosts: myVirthost

  tasks:

  - name: "LIBVIRT-DEPLOY-SECRET: stat pull-secret"
    stat: path=../config/pull-secret.txt
    register: test_pull_secret

  - debug: msg="Pull-Secret URL https://cloud.redhat.com/openshift/install/metal/user-provisioned"
    when: test_pull_secret.stat.exists == false

  - name: "LIBVIRT-DEPLOY-SECRET: fail if pull-secret absent"
    fail: msg="COPY YOUR OCP4 PULL-SECRET HERE ./config/pull-secret.txt"
    when: test_pull_secret.stat.exists == false

- hosts: myBastion

  tasks:

  - name: "LIBVIRT-DEPLOY-SECRET: deploy pull secret"
    template:
      src: "../config/pull-secret.txt"
      dest: "/root/pull-secret.txt"
      owner: root
      group: root
      mode: 0644
